<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="360" viewBox="0 0 1000 360">
  <defs>
    <style>
      .box { fill: #ffffff; stroke: #1f2937; stroke-width: 2; rx: 14; ry: 14; }
      .title { font: 700 16px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #111827; }
      .text { font: 13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #374151; }
      .muted { fill: #6b7280; }
      .arrow { stroke: #111827; stroke-width: 2; fill: none; marker-end: url(#m); }
    </style>
    <marker id="m" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#111827"/>
    </marker>
  </defs>

  <rect x="0" y="0" width="1000" height="360" fill="#f9fafb"/>

  <rect class="box" x="40" y="60" width="210" height="120"/>
  <text class="title" x="145" y="92" text-anchor="middle">.bmad Package</text>
  <text class="text" x="145" y="118" text-anchor="middle">bmad.json</text>
  <text class="text muted" x="145" y="142" text-anchor="middle">workflow.graph.json</text>
  <text class="text muted" x="145" y="164" text-anchor="middle">workflow.md / steps/</text>

  <rect class="box" x="290" y="60" width="220" height="120"/>
  <text class="title" x="400" y="92" text-anchor="middle">Importer + JobRoot</text>
  <text class="text" x="400" y="118" text-anchor="middle">unzip → isolate workspace</text>
  <text class="text muted" x="400" y="142" text-anchor="middle">sandbox root</text>
  <text class="text muted" x="400" y="164" text-anchor="middle">logs / artifacts</text>

  <rect class="box" x="550" y="35" width="410" height="170"/>
  <text class="title" x="755" y="66" text-anchor="middle">Runtime Core（Main Process）</text>
  <text class="text" x="570" y="96">GraphStore: 校验跳转</text>
  <text class="text" x="570" y="120">StateStore: frontmatter 读写/原子落盘</text>
  <text class="text" x="570" y="144">PromptComposer + LLMAdapter</text>
  <text class="text" x="570" y="168">ToolHost: fs.read/write/apply_patch/search</text>

  <rect class="box" x="550" y="230" width="410" height="95"/>
  <text class="title" x="755" y="260" text-anchor="middle">Chat Loop（Cursor 风格）</text>
  <text class="text" x="755" y="286" text-anchor="middle">LLM 决策 next node → 调 ToolCalls → 写入产物与状态</text>

  <path class="arrow" d="M 250 120 L 290 120"/>
  <path class="arrow" d="M 510 120 L 550 120"/>
  <path class="arrow" d="M 755 205 L 755 230"/>
</svg>
