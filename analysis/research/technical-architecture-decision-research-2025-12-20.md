---
stepsCompleted: [1]
inputDocuments: []
workflowType: 'research'
lastStep: 1
research_type: 'technical'
research_topic: 'Architecture Decision: Client vs B/S for Meta-BMAD Platform'
research_goals: 'Determine the optimal architecture (Web vs Desktop vs Hybrid) for a platform that requires both "Workflow Definition" (Visual) and "Workflow Execution" (Context-aware in CAD).'
user_name: 'Mengbin'
date: '2025-12-20'
web_research_enabled: true
source_verification: true
---

# Technical Research: Architecture Decision - Client vs B/S

## Executive Summary

**Decision:** **Hybrid "Package-based" Architecture**
To meet the dual requirements of "Low-barrier Workflow Definition" (Web) and "High-context Workflow Execution" (Desktop CAD), we have defined a **Hybrid Architecture** powered by the **Model Context Protocol (MCP)**.

*   **For the Platform Provider (You):** A universal, scalable standard. You don't build "SolidWorks Integrations"; you build a standard "MCP Client".
*   **For the Industry Expert:** A zero-install Web Builder (React Flow) to define processes.
*   **For the End User:** An offline-capable Electron Client that "drives" their CAD software via local MCP Plugins.

**Core Technology Stack:**
1.  **Definition**: Web (React Flow) -> JSON Schema Package.
2.  **Execution**: Desktop (Electron + Node.js) -> MCP Protocol -> CAD.
3.  **Integration**: MCP Standard (Universal Agent Protocol).

---

## Technical Research Scope Confirmation
**Date:** 2025-12-20

## Technical Research Scope Confirmation

**Research Topic:** Architecture Decision: Client vs B/S for Meta-BMAD Platform
**Research Goals:** Determine the optimal technology stack for a **"Package-based Hybrid"** architecture: Web-based definition (Visual Builder) -> Export "Industry Package" -> Client-side execution (Local Runtime).

**Technical Research Scope:**

- **Architecture Analysis:** "Offline-first" Hybrid Architecture. Detached definition and execution environments.
- **Tech Stack (Definition):** Front-end libraries for Visual Workflow Building (React Flow vs X6).
- **Tech Stack (Package):** Schema design for the "Industry Package" (JSON/YAML structure, bundling assets).
- **Tech Stack (Execution):** Lightweight Client-side Workflow Engine (Node.js/Electron) to interpret the package locally.
- **Integration:** Protocol for the Client Runtime to drive the CAD software.

**Research Methodology:**

- Current web data with rigorous source verification
- Multi-source validation for critical technical claims
- Confidence level framework for uncertain information
- Comprehensive technical coverage with architecture-specific insights

**Scope Confirmed:** 2025-12-20

## Technology Stack Analysis

### Visual Workflow Builder (Web Side)
*   **Recommended: React Flow**
    *   **Why:** Native React library, highly customizable node-based UI, excellent performance for large graphs. The standard for modern "No-code" builders.
    *   **Alternative:** LogicFlow (stronger specifically for flowcharts, but less "App-like" flexibility).
    *   **Decision:** **React Flow** for maximum UI flexibility.

### Client Runtime (Execution Side)
*   **Recommended: Electron + Node.js**
    *   **Why:** Unlocks full local file system access (critical for CAD usage). Allows bundling a local Node.js server to run the "Workflow Engine" offline.
    *   **Context Awareness:** Can load native modules (C++ Addons) or run local servers to communicate with CAD APIs.
    *   **Security:** Context Isolation must be enabled.

### Package Format (The "Industry App")
*   **Structure:** **ZIP Bundle** (renamed to `.bmad` or `.iap`)
    *   `manifest.json`: Meta-info (Author, Version, CAD Compatibility).
    *   `workflow.json`: The standard logic definition (Machine-readable, generated by Visual Builder).
    *   `assets/`: Icons, help docs.
*   **Schema:** Use **JSON Schema** to validate `workflow.json` structure, creating a strict contract between the "Visual Builder" and the "Client Runner".

### Workflow Engine (Client Logic)
*   **Approach:** Custom lightweight engine or **jsWorkflow**.
*   **Requirement:** Must be able to "pause" execution (waiting for User action in CAD) and "resume" (when CAD task done).

## Integration Patterns Analysis

### The Universal Solution: Agent-Driver Protocol
To enable a generic "Agent", we need a standard interface that abstracts the specific application (SolidWorks, AutoCAD, Word, etc.).

**Recommended Standard:** **Model Context Protocol (MCP)**
*   **Origin:** Open standard by Anthropic (Nov 2024).
*   **Concept:**
    *   **Host (Application):** SolidWorks acts as an **MCP Server**. It exposes "Resources" (Model Data) and "Tools" (CAD Functions).
    *   **Client (Agent):** The Electron App acts as an **MCP Client**. It connects to the Host and "discovers" capabilities.
*   **Why it fits:**
    *   **Universal:** The Agent doesn't need to know *how* to extrude, it just calls the `extrude` tool exposed by the server.
    *   **Security:** Clear permission model (Agent asks "Can I run this tool?").
    *   **Ecosystem:** Growing tooling support.

**Architecture for Industry Apps:**
1.  **Provider** writes a "SolidWorks MCP Plugin" (Server).
2.  **Provider** writes a "Generic Agent" (Client).
3.  **Agent** connects to **Plugin** via Stdio or WebSocket.
4.  **Agent** asks: "What tools do you have?" -> Plugin: "I have `create_sketch`, `extrude`".
5.  **Agent** executes logic based on these abstract tools.

## Final Conclusion & Implementation Roadmap

**Confirmed Architecture:** "Meta-BMAD" Universal Platform.

| Module | Technology | Role |
| :--- | :--- | :--- |
| **Visual Builder** | **React Flow** (Web) | UI for drag-and-drop workflow definition. Generates `workflow.json`. |
| **Package Format** | **ZIP Bundle** (`.bmad`) | Container for JSON definition + Assets + helper scripts. |
| **Client Runtime** | **Electron** (Desktop) | Local execution engine. Loads `.bmad` and runs the logic. |
| **Agent Protocol** | **MCP** (Model Context Protocol) | Standard Interface. Client talks to CAD via Localhost WebSocket/Stdio. |
| **CAD Driver** | **MCP Server** (Python/C#) | Small plugin inside CAD that exposes capabilities to the Client. |

### Recommended MVP Steps (Next Phase)

1.  **Product Brief**: Define the "First Industry Vertical" (e.g., Connector Design) to use as the Pilot.
2.  **Architecture**: Design the `workflow.json` Schema and the initial MCP Tool Interfaces (`get_model_properties`, `create_feature`).
3.  **Prototype**: Build a "Hello World" MCP Server for SolidWorks.
